<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amiral Battƒ± - 2-3 Ki≈üilik</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Anchor = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="12" cy="5" r="3"/><line x1="12" y1="22" x2="12" y2="8"/><path d="M5 12H2a10 10 0 0 0 20 0h-3"/>
            </svg>
        );

        const Trophy = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/>
            </svg>
        );

        const Target = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/>
            </svg>
        );

        const AmiraLBatti = () => {
            const GRID_SIZE = 10;
            const SHIPS = [
                { name: 'Zƒ±rhlƒ±', size: 5, emoji: 'üö¢' },
                { name: 'Kruvaz√∂r', size: 4, emoji: '‚õ¥Ô∏è' },
                { name: 'Destroyer', size: 3, emoji: 'üõ•Ô∏è' },
                { name: 'Denizaltƒ±', size: 3, emoji: 'üö§' },
                { name: 'Devriye', size: 2, emoji: '‚õµ' }
            ];

            const [players, setPlayers] = useState(['', '', '']);
            const [maxPlayers, setMaxPlayers] = useState(3);
            const [gamePhase, setGamePhase] = useState('playerCount');
            const [currentPlayer, setCurrentPlayer] = useState(0);
            const [currentShipIndex, setCurrentShipIndex] = useState(0);
            const [shipOrientation, setShipOrientation] = useState('horizontal');
            const [boards, setBoards] = useState([]);
            const [shots, setShots] = useState([]);
            const [hoveredCell, setHoveredCell] = useState(null);
            const [winner, setWinner] = useState(null);
            const [targetPlayer, setTargetPlayer] = useState(null);
            const [showBoard, setShowBoard] = useState(true);
            const [lastShotResult, setLastShotResult] = useState(null);

            useEffect(() => {
                if (players.length > 0) {
                    const initialBoards = players.map(() => 
                        Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null))
                    );
                    const initialShots = players.map(() => 
                        Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null))
                    );
                    setBoards(initialBoards);
                    setShots(initialShots);
                }
            }, [players]);

            const canPlaceShip = (board, row, col, size, orientation) => {
                if (orientation === 'horizontal') {
                    if (col + size > GRID_SIZE) return false;
                    for (let i = 0; i < size; i++) {
                        if (board[row][col + i] !== null) return false;
                    }
                } else {
                    if (row + size > GRID_SIZE) return false;
                    for (let i = 0; i < size; i++) {
                        if (board[row + i][col] !== null) return false;
                    }
                }
                return true;
            };

            const placeShip = (row, col) => {
                if (gamePhase !== 'setup') return;
                const newBoards = [...boards];
                const board = newBoards[currentPlayer];
                const ship = SHIPS[currentShipIndex];
                if (!canPlaceShip(board, row, col, ship.size, shipOrientation)) return;

                if (shipOrientation === 'horizontal') {
                    for (let i = 0; i < ship.size; i++) {
                        board[row][col + i] = { shipIndex: currentShipIndex, partIndex: i };
                    }
                } else {
                    for (let i = 0; i < ship.size; i++) {
                        board[row + i][col] = { shipIndex: currentShipIndex, partIndex: i };
                    }
                }

                setBoards(newBoards);
                if (currentShipIndex < SHIPS.length - 1) {
                    setCurrentShipIndex(currentShipIndex + 1);
                } else if (currentPlayer < players.length - 1) {
                    setCurrentPlayer(currentPlayer + 1);
                    setCurrentShipIndex(0);
                } else {
                    setGamePhase('playing');
                    setCurrentPlayer(0);
                }
            };

            const autoPlaceShips = (playerIndex) => {
                const newBoards = [...boards];
                const board = Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null));
                
                for (let shipIdx = 0; shipIdx < SHIPS.length; shipIdx++) {
                    const ship = SHIPS[shipIdx];
                    let placed = false;
                    let attempts = 0;
                    
                    while (!placed && attempts < 100) {
                        const orientation = Math.random() > 0.5 ? 'horizontal' : 'vertical';
                        const row = Math.floor(Math.random() * GRID_SIZE);
                        const col = Math.floor(Math.random() * GRID_SIZE);
                        
                        if (canPlaceShip(board, row, col, ship.size, orientation)) {
                            if (orientation === 'horizontal') {
                                for (let i = 0; i < ship.size; i++) {
                                    board[row][col + i] = { shipIndex: shipIdx, partIndex: i };
                                }
                            } else {
                                for (let i = 0; i < ship.size; i++) {
                                    board[row + i][col] = { shipIndex: shipIdx, partIndex: i };
                                }
                            }
                            placed = true;
                        }
                        attempts++;
                    }
                }
                
                newBoards[playerIndex] = board;
                setBoards(newBoards);
                setCurrentShipIndex(SHIPS.length - 1);
            };

            const autoPlaceAllPlayers = () => {
                const newBoards = players.map(() => {
                    const board = Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null));
                    
                    for (let shipIdx = 0; shipIdx < SHIPS.length; shipIdx++) {
                        const ship = SHIPS[shipIdx];
                        let placed = false;
                        let attempts = 0;
                        
                        while (!placed && attempts < 100) {
                            const orientation = Math.random() > 0.5 ? 'horizontal' : 'vertical';
                            const row = Math.floor(Math.random() * GRID_SIZE);
                            const col = Math.floor(Math.random() * GRID_SIZE);
                            
                            if (canPlaceShip(board, row, col, ship.size, orientation)) {
                                if (orientation === 'horizontal') {
                                    for (let i = 0; i < ship.size; i++) {
                                        board[row][col + i] = { shipIndex: shipIdx, partIndex: i };
                                    }
                                } else {
                                    for (let i = 0; i < ship.size; i++) {
                                        board[row + i][col] = { shipIndex: shipIdx, partIndex: i };
                                    }
                                }
                                placed = true;
                            }
                            attempts++;
                        }
                    }
                    return board;
                });
                
                setBoards(newBoards);
                setGamePhase('playing');
                setCurrentPlayer(0);
            };

            const makeShot = (row, col) => {
                if (gamePhase !== 'playing' || targetPlayer === null) return;
                const newShots = [...shots];
                if (newShots[currentPlayer][row][col] !== null) return;

                const hit = boards[targetPlayer][row][col] !== null;
                newShots[currentPlayer][row][col] = hit ? 'hit' : 'miss';
                setShots(newShots);
                setLastShotResult({ result: hit ? 'hit' : 'miss', row, col });

                const allShipsSunk = checkAllShipsSunk(targetPlayer);
                if (allShipsSunk) {
                    const remainingPlayers = players.filter((_, idx) => 
                        idx === currentPlayer || !isPlayerDefeated(idx)
                    );
                    if (remainingPlayers.length === 1) {
                        setWinner(currentPlayer);
                        setGamePhase('finished');
                        return;
                    }
                }

                if (!hit) {
                    setTimeout(() => {
                        let nextPlayer = (currentPlayer + 1) % players.length;
                        while (isPlayerDefeated(nextPlayer)) {
                            nextPlayer = (nextPlayer + 1) % players.length;
                        }
                        setCurrentPlayer(nextPlayer);
                        setTargetPlayer(null);
                        setShowBoard(true);
                        setLastShotResult(null);
                    }, 2000);
                } else {
                    setTimeout(() => {
                        setTargetPlayer(null);
                        setShowBoard(true);
                        setLastShotResult(null);
                    }, 1500);
                }
            };

            const isPlayerDefeated = (playerIndex) => {
                const board = boards[playerIndex];
                if (!board) return false;
                for (let i = 0; i < GRID_SIZE; i++) {
                    for (let j = 0; j < GRID_SIZE; j++) {
                        if (board[i][j] !== null) {
                            const allHit = players.some((_, attackerIdx) => {
                                if (attackerIdx === playerIndex) return false;
                                return shots[attackerIdx]?.[i]?.[j] === 'hit';
                            });
                            if (!allHit) return false;
                        }
                    }
                }
                return true;
            };

            const checkAllShipsSunk = (playerIndex) => {
                const board = boards[playerIndex];
                for (let i = 0; i < GRID_SIZE; i++) {
                    for (let j = 0; j < GRID_SIZE; j++) {
                        if (board[i][j] !== null) {
                            const isHit = shots.some((playerShots, attackerIdx) => {
                                if (attackerIdx === playerIndex) return false;
                                return playerShots[i][j] === 'hit';
                            });
                            if (!isHit) return false;
                        }
                    }
                }
                return true;
            };

            const renderCell = (row, col, isPlayerBoard) => {
                let content = '';
                let bgColor = 'bg-blue-50';
                
                if (gamePhase === 'setup' && isPlayerBoard) {
                    const cell = boards[currentPlayer]?.[row]?.[col];
                    if (cell !== null) {
                        bgColor = 'bg-emerald-400';
                        content = SHIPS[cell.shipIndex].emoji;
                    }
                } else if (gamePhase === 'playing' && !isPlayerBoard && targetPlayer !== null) {
                    const shot = shots[currentPlayer]?.[row]?.[col];
                    if (shot === 'hit') {
                        bgColor = 'bg-red-500';
                        content = 'üí•';
                    } else if (shot === 'miss') {
                        bgColor = 'bg-blue-300';
                        content = 'üí®';
                    }
                }

                return (
                    <div
                        key={`${row}-${col}`}
                        onClick={() => {
                            if (gamePhase === 'setup' && isPlayerBoard) {
                                placeShip(row, col);
                            } else if (gamePhase === 'playing' && !isPlayerBoard && targetPlayer !== null) {
                                makeShot(row, col);
                            }
                        }}
                        className={`aspect-square border-2 border-blue-900/20 flex items-center justify-center text-lg md:text-xl transition-all cursor-pointer hover:border-blue-600 hover:scale-105 ${bgColor}`}
                    >
                        {content}
                    </div>
                );
            };

            const renderGrid = (isPlayerBoard = false) => {
                return (
                    <div className="grid grid-cols-10 gap-0.5 bg-blue-900/10 p-2 rounded-lg shadow-xl max-w-md mx-auto">
                        {Array(GRID_SIZE).fill(null).map((_, row) => 
                            Array(GRID_SIZE).fill(null).map((_, col) => renderCell(row, col, isPlayerBoard))
                        )}
                    </div>
                );
            };

            if (boards.length === 0) {
                return <div className="min-h-screen flex items-center justify-center">Y√ºkleniyor...</div>;
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-sky-400 via-blue-500 to-indigo-600 p-4 md:p-8">
                    <div className="max-w-4xl mx-auto">
                        <div className="text-center mb-8">
                            <div className="flex items-center justify-center gap-3 mb-4">
                                <Anchor className="w-12 h-12 text-yellow-300 animate-bounce" />
                                <h1 className="text-4xl md:text-6xl font-bold text-white drop-shadow-lg">Amiral Battƒ±</h1>
                                <Anchor className="w-12 h-12 text-yellow-300 animate-bounce" />
                            </div>
                            <p className="text-xl text-white/90 font-semibold">2-3 Ki≈üilik Deniz Sava≈üƒ±</p>
                        </div>

                        <div className="bg-white/95 rounded-2xl p-6 shadow-2xl mb-6">
                            {gamePhase === 'playerCount' && (
                                <div className="text-center">
                                    <h2 className="text-3xl font-bold text-blue-900 mb-6">Ka√ß Ki≈üi Oynayacaksƒ±nƒ±z?</h2>
                                    <div className="flex justify-center gap-6 mb-8">
                                        <button onClick={() => { setMaxPlayers(2); setPlayers(['', '']); }} className="px-12 py-8 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-3xl">2 Ki≈üi</button>
                                        <button onClick={() => { setMaxPlayers(3); setPlayers(['', '', '']); }} className="px-12 py-8 bg-green-600 hover:bg-green-700 text-white rounded-xl font-bold text-3xl">3 Ki≈üi</button>
                                    </div>
                                    <button onClick={() => setGamePhase('nameInput')} className="px-8 py-4 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-bold text-xl">Devam ‚Üí</button>
                                </div>
                            )}

                            {gamePhase === 'nameInput' && (
                                <div className="text-center">
                                    <h2 className="text-3xl font-bold text-blue-900 mb-6">Oyuncularƒ±n ƒ∞simlerini Girin</h2>
                                    <div className="space-y-4 max-w-md mx-auto mb-6">
                                        {players.map((name, idx) => (
                                            <div key={idx} className="flex items-center gap-3">
                                                <label className="text-lg font-bold text-blue-900 w-24">Oyuncu {idx + 1}:</label>
                                                <input type="text" value={name} onChange={(e) => { const newPlayers = [...players]; newPlayers[idx] = e.target.value; setPlayers(newPlayers); }} placeholder={`Oyuncu ${idx + 1}'in adƒ±`} className="flex-1 px-4 py-3 border-2 border-blue-300 rounded-lg text-lg" maxLength={15} />
                                            </div>
                                        ))}
                                    </div>
                                    <button onClick={() => { if (players.every(n => n.trim() !== '')) setGamePhase('setup'); else alert('L√ºtfen t√ºm oyuncularƒ±n isimlerini girin!'); }} disabled={!players.every(n => n.trim() !== '')} className={`px-8 py-4 rounded-lg font-bold text-xl ${players.every(n => n.trim() !== '') ? 'bg-green-600 hover:bg-green-700 text-white' : 'bg-gray-300 text-gray-500'}`}>Oyuna Ba≈üla! üöÄ</button>
                                </div>
                            )}

                            {gamePhase === 'setup' && (
                                <>
                                    <div className="text-center mb-4">
                                        <h2 className="text-2xl font-bold text-blue-900 mb-2">{players[currentPlayer]} - Gemi Yerle≈ütirme</h2>
                                        <p className="text-lg text-blue-700">{SHIPS[currentShipIndex].emoji} {SHIPS[currentShipIndex].name} ({SHIPS[currentShipIndex].size} birim)</p>
                                    </div>
                                    <div className="flex justify-center gap-4 mb-6">
                                        <button onClick={() => setShipOrientation('horizontal')} className={`px-6 py-3 rounded-lg font-bold ${shipOrientation === 'horizontal' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'}`}>Yatay ‚ÜîÔ∏è</button>
                                        <button onClick={() => setShipOrientation('vertical')} className={`px-6 py-3 rounded-lg font-bold ${shipOrientation === 'vertical' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'}`}>Dikey ‚ÜïÔ∏è</button>
                                    </div>
                                    <div className="flex justify-center gap-3 mb-6 flex-wrap">
                                        <button onClick={() => autoPlaceShips(currentPlayer)} className="px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-bold">üé≤ Otomatik</button>
                                        <button onClick={() => { const newBoards = [...boards]; newBoards[currentPlayer] = Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null)); setBoards(newBoards); setCurrentShipIndex(0); }} className="px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-bold">üîÑ Sƒ±fƒ±rla</button>
                                        {currentPlayer === 0 && currentShipIndex === 0 && (
                                            <button onClick={autoPlaceAllPlayers} className="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-bold">‚ö° Herkesi Otomatik</button>
                                        )}
                                    </div>
                                    {renderGrid(true)}
                                </>
                            )}

                            {gamePhase === 'playing' && (
                                <>
                                    {lastShotResult && (
                                        <div className="fixed inset-0 flex items-center justify-center z-50 pointer-events-none">
                                            <div className={`text-6xl md:text-8xl font-bold px-8 py-6 rounded-3xl shadow-2xl animate-bounce ${lastShotResult.result === 'hit' ? 'bg-red-600 text-white' : 'bg-blue-400 text-white'}`}>
                                                {lastShotResult.result === 'hit' ? 'üéØ VURDU! üí•' : '‚ùå ISKALADI üí®'}
                                            </div>
                                        </div>
                                    )}
                                    <div className="text-center mb-4">
                                        <h2 className="text-2xl font-bold text-blue-900 mb-2 flex items-center justify-center gap-2">
                                            <Target className="w-8 h-8" />{players[currentPlayer]}'in Sƒ±rasƒ±
                                        </h2>
                                        {targetPlayer === null ? (
                                            <>
                                                <p className="text-lg text-blue-700 mb-4">Kime ate≈ü edeceksin?</p>
                                                <div className="flex justify-center gap-4 flex-wrap">
                                                    {players.map((player, idx) => {
                                                        if (idx === currentPlayer || isPlayerDefeated(idx)) return null;
                                                        return <button key={idx} onClick={() => { setTargetPlayer(idx); setShowBoard(true); }} className="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-bold">{player}</button>;
                                                    })}
                                                </div>
                                            </>
                                        ) : (
                                            <>
                                                <p className="text-lg text-red-600 mb-2">Hedef: {players[targetPlayer]} üéØ</p>
                                                <p className="text-sm text-green-600 font-bold mb-4">üí° Vurursan tekrar atƒ±≈ü hakkƒ± kazanƒ±rsƒ±n!</p>
                                                {renderGrid(false)}
                                            </>
                                        )}
                                    </div>
                                    <div className={`grid ${maxPlayers === 3 ? 'grid-cols-3' : 'grid-cols-2'} gap-2 mt-6`}>
                                        {players.map((player, idx) => (
                                            <div key={idx} className={`p-3 rounded-lg text-center font-bold ${isPlayerDefeated(idx) ? 'bg-gray-300 text-gray-600' : idx === currentPlayer ? 'bg-yellow-400 text-yellow-900' : 'bg-blue-200 text-blue-900'}`}>
                                                {player}{isPlayerDefeated(idx) && ' ‚ùå'}{idx === currentPlayer && ' üëà'}
                                            </div>
                                        ))}
                                    </div>
                                </>
                            )}

                            {gamePhase === 'finished' && (
                                <div className="text-center">
                                    <Trophy className="w-24 h-24 text-yellow-400 mx-auto mb-4 animate-bounce" />
                                    <h2 className="text-4xl font-bold text-blue-900 mb-4">üéâ {players[winner]} Kazandƒ±! üéâ</h2>
                                    <div className="flex justify-center gap-4 flex-wrap">
                                        <button onClick={() => { setGamePhase('setup'); setCurrentPlayer(0); setCurrentShipIndex(0); setTargetPlayer(null); const initialBoards = players.map(() => Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null))); const initialShots = players.map(() => Array(GRID_SIZE).fill(null).map(() => Array(GRID_SIZE).fill(null))); setBoards(initialBoards); setShots(initialShots); }} className="px-8 py-4 bg-green-600 hover:bg-green-700 text-white rounded-lg font-bold text-xl">Yeni Oyun üîÑ</button>
                                        <button onClick={() => { setPlayers(['', '', '']); setGamePhase('playerCount'); setCurrentPlayer(0); setCurrentShipIndex(0); setTargetPlayer(null); }} className="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold text-xl">ƒ∞simleri Deƒüi≈ütir ‚úèÔ∏è</button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    <div className="fixed bottom-4 right-4 bg-white/90 px-4 py-2 rounded-lg shadow-lg z-50">
                        <p className="text-sm text-gray-700"><span className="font-semibold">Designed by</span> Ali Deveci</p>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AmiraLBatti />);
    </script>
</body>
</html>
